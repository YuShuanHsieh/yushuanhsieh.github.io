<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A technical blog about software engineering, system design, and modern development practices."><meta name=author content="Cherie Hsieh"><title>AngularJS - angular-formly study notes — Cherie's Tech Blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href="/css/style.css?v=1771496292"></head><body><header class=site-header><div class=header-inner><a href=https://yushuanhsieh.github.io/ class=site-logo><span class=logo-icon>⟨/⟩</span>
<span class=logo-text>Cherie's Tech Blog</span></a><nav class=site-nav><a href=/ class=nav-link>Home</a>
<a href=/posts/ class=nav-link>Posts</a>
<a href=/categories/ class=nav-link>Categories</a>
<a href=/about/ class=nav-link>About</a></nav><button class=mobile-menu-toggle aria-label="Toggle menu">
<span></span>
<span></span>
<span></span></button></div></header><main class=site-main><article class=single-post><header class=post-header><h1 class=post-title>AngularJS - angular-formly study notes</h1><div class=post-meta><time datetime=2018-01-05>January 5, 2018</time>
<span class=separator>·</span>
<span class=reading-time>7 min read</span></div><div class=post-categories><a href=https://yushuanhsieh.github.io/categories/web/>Web</a></div></header><div class=post-content><h2 id=angular-formly-運作原理>Angular formly 運作原理</h2><p>將 form 中的每個 field 獨立出來寫成共用 template，並供整個 app 使用。使用者先在 angular-formly 中進行 configuration，包含設定 type 和 wrapper ，接著只要在 component 的 controller 中建立指定 type 的 field objects 之後，angular-formly 就會結合之前設定好的 field template 和 objects， render 出完整的表單。
![study.png]({{ site.url }}/assets/images/angular-formly-usage-1.png)</p><h4 id=angular-formly-field-render-source-code>Angular-formly field render source code</h4><p>Angular-formly 套用 field template 的順序流程：</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>getFieldTemplate</span><span style=color:#1f2328>(</span><span style=color:#1f2328>scope</span><span style=color:#1f2328>.</span><span style=color:#1f2328>options</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#1f2328>then</span><span style=color:#1f2328>(</span><span style=color:#1f2328>runManipulators</span><span style=color:#1f2328>(</span><span style=color:#1f2328>fieldManipulators</span><span style=color:#1f2328>.</span><span style=color:#1f2328>preWrapper</span><span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#1f2328>then</span><span style=color:#1f2328>(</span><span style=color:#1f2328>transcludeInWrappers</span><span style=color:#1f2328>(</span><span style=color:#1f2328>scope</span><span style=color:#1f2328>.</span><span style=color:#1f2328>options</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>scope</span><span style=color:#1f2328>.</span><span style=color:#1f2328>formOptions</span><span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#1f2328>then</span><span style=color:#1f2328>(</span><span style=color:#1f2328>runManipulators</span><span style=color:#1f2328>(</span><span style=color:#1f2328>fieldManipulators</span><span style=color:#1f2328>.</span><span style=color:#1f2328>postWrapper</span><span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#1f2328>then</span><span style=color:#1f2328>(</span><span style=color:#1f2328>setElementTemplate</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#1f2328>then</span><span style=color:#1f2328>(</span><span style=color:#1f2328>watchFormControl</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#1f2328>then</span><span style=color:#1f2328>(</span><span style=color:#1f2328>callLinkFunctions</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>.</span><span style=color:#cf222e>catch</span><span style=color:#1f2328>(</span><span style=color:#1f2328>error</span> <span style=color:#1f2328>=&gt;</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>formlyWarn</span><span style=color:#1f2328>(</span>
</span></span><span style=display:flex><span>          <span style=color:#0a3069>&#39;there-was-a-problem-setting-the-template-for-this-field&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>          <span style=color:#0a3069>&#39;There was a problem setting the template for this field &#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>          <span style=color:#1f2328>scope</span><span style=color:#1f2328>.</span><span style=color:#1f2328>options</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>          <span style=color:#1f2328>error</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>})</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=set-up-field-templates>Set Up Field Templates</h2><h3 id=--prebuilt-template>- Prebuilt Template</h3><p>在使用 angular-formly 之前必須先定義好各 field 的 template。目前有幾個已經建好的簡易 formly template，包含：</p><ol><li>Boostrap</li><li>LumX</li><li>lonic</li></ol><p>不過目前這些 template module 都已經沒在維護，所以還是自己寫一個 template 比較妥當。</p><h4 id=pre-built-template-使用方式>Pre-built template 使用方式</h4><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>import</span> <span style=color:#0a3069>&#39;angular-formly-templates-bootstrap&#39;</span><span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span><span style=color:#57606a>// inject to the module
</span></span></span><span style=display:flex><span><span style=color:#1f2328>.</span><span style=color:#1f2328>module</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;myApp&#39;</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>[</span><span style=color:#0a3069>&#39;formly&#39;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#39;formlyBootstrap&#39;</span><span style=color:#1f2328>]);</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>[Notice]</strong> 使用之前，請先看 template 的 source code，確認好有哪些 type 有被定義，不然會報錯。（例如: formlyBootstrap 並沒有定義switch type，因此無法使用。）</p><hr><h3 id=--use-custom-template>- Use Custom Template</h3><h5 id=api-documents-formlyconfig><a href=http://docs.angular-formly.com/v8.0.0/docs/formlyconfig>API Documents: formlyConfig</a></h5><p>使用 <code>formlyConfig</code> 或 <code>formlyConfigProvider</code> 來定義自己的 field template。</p><h5 id=example1-use-formlyconfig>Example1: use <code>formlyConfig</code></h5><p>在 module.run 中設定的好處是，可以 inject 其他想要的 service。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>module</span><span style=color:#1f2328>.</span><span style=color:#1f2328>run</span><span style=color:#1f2328>((</span><span style=color:#1f2328>formlyConfig</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>MyService</span><span style=color:#1f2328>)</span> <span style=color:#1f2328>=&gt;</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>formlyConfig</span><span style=color:#1f2328>.</span><span style=color:#1f2328>setType</span><span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a>// Set a type object.
</span></span></span><span style=display:flex><span>    <span style=color:#57606a>// MyService could be used in controller.
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>});</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>});</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=example2-use-formlyconfigprovider>Example2: use <code>formlyConfigProvider</code></h5><p>在 cinfig 階段設定，則無法引入 service ，因為該階段 service 還未被建立。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>module</span><span style=color:#1f2328>.</span><span style=color:#1f2328>config</span><span style=color:#1f2328>(</span><span style=color:#1f2328>formlyConfigProvider</span> <span style=color:#1f2328>=&gt;</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>formlyConfigProvider</span><span style=color:#1f2328>.</span><span style=color:#1f2328>setType</span><span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a>// Set a type object.
</span></span></span><span style=display:flex><span>    <span style=color:#57606a>// You cannot inject your services in a config stage.
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>});</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=api-reference>API Reference</h3><h3 id=1-settype>1. setType</h3><h5 id=example-1>Example 1:</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>formlyConfig</span><span style=color:#1f2328>.</span><span style=color:#1f2328>setType</span><span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// 定義 field type
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>name</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;input&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>template</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;&lt;input ng-model=&#34;model[options.key]&#34; /&gt;&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// 必須使用 model[options.key]，因為是要指定 options.key 的值為 model 對象
</span></span></span><span style=display:flex><span><span style=color:#1f2328>});</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=example-2>Example 2:</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>formlyConfig</span><span style=color:#1f2328>.</span><span style=color:#1f2328>setType</span><span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>name</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;ipAddress&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#cf222e>extends</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;input&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// 用來包裝 field template 的 wrapper template.
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>wrapper</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;someWrapper&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// 加入自訂 property。
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>defaultOptions</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{},</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>link</span><span style=color:#0550ae>:</span> <span style=color:#cf222e>function</span><span style=color:#1f2328>(</span><span style=color:#1f2328>scope</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>el</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>attrs</span><span style=color:#1f2328>)</span> <span style=color:#1f2328>{},</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// 該controller 的觸發時間為 formly-field(internal API) 之後，field controller 之前。
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>controller</span><span style=color:#0550ae>:</span> <span style=color:#cf222e>function</span><span style=color:#1f2328>(</span><span style=color:#1f2328>$scope</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>yourInjectableThing</span><span style=color:#1f2328>)</span> <span style=color:#1f2328>{},</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// 欄位驗證
</span></span></span><span style=display:flex><span>  <span style=color:#1f2328>apiCheck</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{}</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>});</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>[Notice]</strong> Just be aware that angular-formly does make use of <em>common parameters</em> like required or onClick to automatically add attributes to ng-model elements.</p><h4 id=some-properties-of-config>Some properties of config:</h4><ul><li><strong>name</strong>
field refernece.(Required!)</li><li><strong>templateUrl or template</strong>
(use $templateCache) 套用於該 field 的 template(通常是HTML格式).</li><li><strong>wrapper</strong>
額外加入 template 在 field template 外層。</li><li><strong>apiCheck</strong>
Default setting uses <code>apiCheck</code> library.</li></ul><h5 id=example-for-apicheck>*Example for apiCheck:</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>apiCheck</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>check</span> <span style=color:#1f2328>=&gt;</span> <span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>          <span style=color:#1f2328>templateOptions</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>label</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>check</span><span style=color:#1f2328>.</span><span style=color:#1f2328>string</span><span style=color:#1f2328>.</span><span style=color:#1f2328>optional</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>required</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>check</span><span style=color:#1f2328>.</span><span style=color:#1f2328>bool</span><span style=color:#1f2328>.</span><span style=color:#1f2328>optional</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>labelSrOnly</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>check</span><span style=color:#1f2328>.</span><span style=color:#1f2328>bool</span><span style=color:#1f2328>.</span><span style=color:#1f2328>optional</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>          <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p><strong>extend</strong>
(需注意如果在 extend type 設置和母 type 一樣的 wrapper 會造成衝突，請重新設置一個新的type。)</p></li><li><p><strong>defaultOptions</strong>
在該欄位中加入自定義的 options 供使用者調整。</p></li></ul><h5 id=example-for-defaultoptions>*Example for defaultOptions:</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>defaultOptions</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>ngModelAttrs</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a>// 在 type的 attribute 中加入 rows 和 mdMaxLength 屬性。
</span></span></span><span style=display:flex><span>    <span style=color:#1f2328>rows</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{</span><span style=color:#1f2328>attribute</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;rows&#39;</span><span style=color:#1f2328>},</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>mdMaxLength</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{</span><span style=color:#1f2328>attribute</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;md-maxlength&#39;</span><span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-setwrapper>2. setWrapper</h3><p>定義 wrapper 的寫法和定義 field 寫法雷同，不過template 中需加入指定 html tag。</p><ul><li>需使用 <code>&lt;formly-transclude>&lt;/formly-transclude></code> 來指定 field template 的位置。</li><li>至少要有 <code>templateUrl</code> 或 <code>template</code>。</li></ul><h5 id=wapper-template-example>*wapper template example：</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#1f2328>&lt;</span><span style=color:#0550ae>div</span><span style=color:#1f2328>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>&lt;</span><span style=color:#0550ae>label</span><span style=color:#1f2328>&gt;</span>
</span></span><span style=display:flex><span>    {{to.label}}
</span></span><span style=display:flex><span>    {{to.required ? &#39;*&#39; : &#39;&#39;}}
</span></span><span style=display:flex><span>  <span style=color:#1f2328>&lt;/</span><span style=color:#0550ae>label</span><span style=color:#1f2328>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>&lt;!-- 需使用&lt;formly-transclude&gt; 來指定 field template 放置的位置 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>&lt;</span><span style=color:#0550ae>formly-transclude</span><span style=color:#1f2328>&gt;&lt;/</span><span style=color:#0550ae>formly-transclude</span><span style=color:#1f2328>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>&lt;/</span><span style=color:#0550ae>div</span><span style=color:#1f2328>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><hr><p>###[ 其他重點 ] Template&rsquo;s $scope</p><p>在寫 controller 或 expressionProperties function 的時候，可以使用$scope 來操作 template 中的變數。這邊要注意的是， angular-formly 的 $scope 有調整過，新增一些 formly 特有屬性，所以要使用指定的 property 去取得 model 參數。</p><h4 id=常用的property>常用的property</h4><table><thead><tr><th>Variable Name</th><th style=text-align:center>Description</th></tr></thead><tbody><tr><td>options</td><td style=text-align:center>此 object 包含設定 field 的參數，例如: formControl, initModel等。</td></tr><tr><td>to</td><td style=text-align:center>= <code>options.templateOptions</code></td></tr><tr><td>fc</td><td style=text-align:center>= <code>options.formControl</code></td></tr></tbody></table><h5 id=templates-scope-example-1>*template&rsquo;s $scope example 1</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#1f2328>&lt;</span><span style=color:#0550ae>label</span><span style=color:#1f2328>&gt;</span>{{ to.label }}<span style=color:#1f2328>&lt;/</span><span style=color:#0550ae>label</span><span style=color:#1f2328>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=templates-scope-example-2>*template&rsquo;s $scope example 2</h5><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span>  <span style=color:#1f2328>key</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;priority&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>type</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;radio&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>defaultValue</span><span style=color:#0550ae>:</span> <span style=color:#cf222e>this</span><span style=color:#1f2328>.</span><span style=color:#1f2328>item</span><span style=color:#1f2328>.</span><span style=color:#1f2328>priority</span> <span style=color:#0550ae>||</span> <span style=color:#0550ae>1</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>templateOptions</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>label</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;Priority&#39;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>options</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>[]</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>},</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>controller</span><span style=color:#0550ae>:</span> <span style=color:#cf222e>function</span><span style=color:#1f2328>(</span><span style=color:#1f2328>$scope</span><span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>$scope</span><span style=color:#1f2328>.</span><span style=color:#1f2328>to</span><span style=color:#1f2328>.</span><span style=color:#1f2328>options</span> <span style=color:#0550ae>=</span> <span style=color:#1f2328>[</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>{</span> <span style=color:#1f2328>value</span><span style=color:#0550ae>:</span> <span style=color:#0550ae>1</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>label</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;Urgent&#39;</span> <span style=color:#1f2328>},</span>
</span></span><span style=display:flex><span>      <span style=color:#1f2328>{</span> <span style=color:#1f2328>value</span><span style=color:#0550ae>:</span> <span style=color:#0550ae>2</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>label</span><span style=color:#0550ae>:</span> <span style=color:#0a3069>&#39;Normal&#39;</span> <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>];</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=field-configuration>Field configuration</h2><h3 id=property>Property</h3><ul><li>key
key 會與 controller 的 model 綁定(controller.model.keyName)。預設 key 值是 field object array 的 index。</li><li>type
這個是指欄位的型別，例如 input / checkbox / switch / select 等。<strong>注意：type 需在 formlyConfig 被定義，也可直接使用現有的template</strong>。</li><li>templateOption</li><li>defaultValue
initialize model. 如果該 model 在 compile-time 中為 undefined，則會 assign 此初始值。<em>if you want to default values in the form, simply initialize your model with that state and you&rsquo;re good. However, there are some use cases where it is much easier to use the form config to initialize the model, which is why this property was added.</em></li><li>hideExpression (string || function)</li><li>expressionProperties (object)</li><li>model
這個用在當 field 的 model 和 formly 的model 為不同的時候。可配合<code>expressionProperties</code>（a <strong>deep watch</strong> is added to the formly-field directive&rsquo;s scope to run the <strong>expressionProperties</strong> when the specified model changes）。</li></ul></div><footer class=post-footer><div class=post-nav><a href=https://yushuanhsieh.github.io/posts/2017-12-08-two-way-binding/ class="post-nav-link prev"><span class=label>← Previous</span>
<span class=title>AngularJS - Two way data binding</span>
</a><a href=https://yushuanhsieh.github.io/posts/2018-01-29-cypress-basic-usage/ class="post-nav-link next"><span class=label>Next →</span>
<span class=title>Cypress & Cucumber Introduction</span></a></div></footer></article></main><footer class=site-footer><div class=footer-inner><p class=footer-copyright>&copy; 2026 Cherie's Tech Blog. All rights reserved.</p><p class=footer-powered>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></p></div></footer></body></html>