<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A technical blog about software engineering, system design, and modern development practices."><meta name=author content="Cherie Hsieh"><title>CSS Typed Object Model — Cherie's Tech Blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href="/css/style.css?v=1771486583"></head><body><header class=site-header><div class=header-inner><a href=https://yushuanhsieh.github.io/ class=site-logo><span class=logo-icon>⟨/⟩</span>
<span class=logo-text>Cherie's Tech Blog</span></a><nav class=site-nav><a href=/ class=nav-link>Home</a>
<a href=/posts/ class=nav-link>Posts</a>
<a href=/categories/ class=nav-link>Categories</a>
<a href=/about/ class=nav-link>About</a></nav><button class=mobile-menu-toggle aria-label="Toggle menu">
<span></span>
<span></span>
<span></span></button></div></header><main class=site-main><article class=single-post><header class=post-header><h1 class=post-title>CSS Typed Object Model</h1><div class=post-meta><time datetime=2018-06-24>June 24, 2018</time>
<span class=separator>·</span>
<span class=reading-time>6 min read</span></div><div class=post-categories><a href=https://yushuanhsieh.github.io/categories/web/>Web</a></div></header><div class=post-content><h2 id=前言>前言</h2><p>Chrome 66 版本全新支援 <code>CSS Typed Object Model</code>，透過這種新型的 CSS Typed OM，可以有效提升使用 JavaScript 操作 CSSOM 屬性的效率。雖然目前僅有 Chrome 支援（ Firefox 據說在努力中， Edge 目前沒下文），不過既然此方式能對網頁呈現效能有所提升，讓開發者和使用者都因此受惠，未來想必會成為主流方式。</p><h2 id=cssom--css-typed-object-model>CSSOM & CSS Typed Object Model</h2><h3 id=cssom>CSSOM</h3><p>傳統的 CSSOM 是使用 string 格式來進行 style 修改或是讀取等行為，當開發者傳遞一個 string 內容給 CSSOM 時，它會再解析 string 成真正需要的數值。這樣一來一往需要蠻大的成本，再加上開發者傳送 string 時不好偵錯，以及不方便開發者進行一些數值的運算等，讓傳統 CSSOM 似乎不太適合樣式操作。</p><p>Example</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>el</span> <span style=color:#0550ae>=</span> <span style=color:#6639ba>document</span><span style=color:#1f2328>.</span><span style=color:#1f2328>querySelector</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;.container&#39;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>style</span><span style=color:#1f2328>.</span><span style=color:#1f2328>opacity</span> <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;0.2&#39;</span><span style=color:#1f2328>;</span> <span style=color:#57606a>//pass string type value to CSSOM
</span></span></span></code></pre></td></tr></table></div></div><h3 id=css-typed-object-model>CSS Typed Object Model</h3><p>針對 CSSOM 產生的種種不便，於是大神們提出 <code>CSS Typed Object Model</code> 解決方案，使用更直覺的方式來操作 CSS 樣式數值。大致概念就是使用專屬的 JS object 來代表這些屬性，同時並新增 CSS Value Object 來規範可接受的數值。 這樣不但有利於開發者運用，而且更強化可讀性。</p><p>想像一下，如果你需要獲得 Element 當前的 opacity 數值並且增加它，根據 CSSOM 的方式，它會回傳一個 string type 的 value 給你，而新型的 CSS Typed Object Model 是會回傳 number type，後者的方式還是比較好吧。</p><p>Example</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>el</span> <span style=color:#0550ae>=</span> <span style=color:#6639ba>document</span><span style=color:#1f2328>.</span><span style=color:#1f2328>querySelector</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;.container&#39;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>attributeStyleMap</span><span style=color:#1f2328>.</span><span style=color:#1f2328>set</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;opacity&#39;</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>0.2</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>value</span> <span style=color:#0550ae>=</span> <span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>attributeStyleMap</span><span style=color:#1f2328>.</span><span style=color:#1f2328>get</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;opacity&#39;</span><span style=color:#1f2328>).</span><span style=color:#1f2328>value</span><span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span><span style=color:#57606a>// value = 0.2
</span></span></span></code></pre></td></tr></table></div></div><h2 id=css-typed-object-model-1>CSS Typed Object Model</h2><h3 id=stylepropertymap>StylePropertyMap</h3><p>在上面例子有看到一個新的 Element Property <code>attributeStyleMap</code>，這是在 <code>CSS Typed Object Model</code> 定義一種代表 CSS declaration block 的物件。(interface 為 <code>StylePropertyMap</code>)，可以透過內定義的 methods 來讀取或是修改特定 CSS property。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>interface</span> <span style=color:#1f2328>StylePropertyMap</span><span style=color:#fff> </span><span style=color:#1f2328>:</span><span style=color:#fff> </span>StylePropertyMapReadOnly<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>set</span><span style=color:#1f2328>(</span>USVString<span style=color:#fff> </span>property<span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>CSSStyleValue<span style=color:#fff> </span>or<span style=color:#fff> </span>USVString<span style=color:#1f2328>)...</span><span style=color:#fff> </span>values<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>append</span><span style=color:#1f2328>(</span>USVString<span style=color:#fff> </span>property<span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>CSSStyleValue<span style=color:#fff> </span>or<span style=color:#fff> </span>USVString<span style=color:#1f2328>)...</span><span style=color:#fff> </span>values<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>delete</span><span style=color:#1f2328>(</span>USVString<span style=color:#fff> </span>property<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>clear</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>};</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>這比起使用 CSSOM 所產生的 <a href=https://drafts.csswg.org/cssom-1/#cssstyledeclaration><code>CSSStyleDeclaration</code></a>有很大的不同，使用方式也更為簡潔。</p><h3 id=computedstylemap>computedStyleMap()</h3><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span>partial<span style=color:#fff> </span><span style=color:#cf222e>interface</span> <span style=color:#1f2328>Element</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#0550ae>[</span>SameObject<span style=color:#0550ae>]</span><span style=color:#fff> </span>StylePropertyMapReadOnly<span style=color:#fff> </span><span style=color:#6639ba>computedStyleMap</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>};</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p><code>CSS Typed Object Model</code> 另一個好處就是提供了運算後的數值結果，例如在官方文件有提到：</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>attributeStyleMap</span><span style=color:#1f2328>.</span><span style=color:#1f2328>set</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;z-index&#39;</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>CSS</span><span style=color:#1f2328>.</span><span style=color:#1f2328>number</span><span style=color:#1f2328>(</span><span style=color:#0550ae>15.4</span><span style=color:#1f2328>));</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>computedStyleMap</span><span style=color:#1f2328>().</span><span style=color:#1f2328>get</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#39;z-index&#39;</span><span style=color:#1f2328>).</span><span style=color:#1f2328>value</span> <span style=color:#0550ae>===</span> <span style=color:#0550ae>15</span>   <span style=color:#57606a>// computed style is rounded.
</span></span></span></code></pre></td></tr></table></div></div><p>由於 <code>z-index</code> 屬性僅接受 interger ，所以即使是設定不可被接受的小數點數值，在最後運算時還是會被調整成 Property 正確的範圍數值。</p><h3 id=css-numeric-factory-functions>CSS Numeric Factory Functions</h3><p>在 CSS 中有好幾種代表單位，例如 <code>em</code> <code>px</code> <code>deg</code>等，以往我們在設定時就會直接寫：</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>style</span><span style=color:#1f2328>.</span><span style=color:#1f2328>transform</span><span style=color:#0550ae>=</span><span style=color:#0a3069>`rotate(0,0,1,</span><span style=color:#0a3069>${</span><span style=color:#1f2328>angle</span><span style=color:#0a3069>}</span><span style=color:#0a3069>deg)`</span><span style=color:#1f2328>;</span>
</span></span></code></pre></td></tr></table></div></div><p>這其實是很不直覺的寫法，有可能會因為打錯單位而無法正確顯示。因此透過 <code>Numeric Factory Functions</code> 的協助，我們可以透過指定的 functions 來產生出正確的數字和單位。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span>partial<span style=color:#fff> </span>namespace<span style=color:#fff> </span>CSS<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span>CSSUnitValue<span style=color:#fff> </span><span style=color:#6639ba>number</span><span style=color:#1f2328>(</span><span style=color:#cf222e>double</span><span style=color:#fff> </span>value<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span>CSSUnitValue<span style=color:#fff> </span><span style=color:#6639ba>percent</span><span style=color:#1f2328>(</span><span style=color:#cf222e>double</span><span style=color:#fff> </span>value<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span>CSSUnitValue<span style=color:#fff> </span><span style=color:#6639ba>em</span><span style=color:#1f2328>(</span><span style=color:#cf222e>double</span><span style=color:#fff> </span>value<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#57606a>// ...more</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>example</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>rotate</span> <span style=color:#0550ae>=</span> <span style=color:#cf222e>new</span> <span style=color:#1f2328>CSSRotate</span><span style=color:#1f2328>(</span><span style=color:#0550ae>0</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>0</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>1</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>CSS</span><span style=color:#1f2328>.</span><span style=color:#1f2328>deg</span><span style=color:#1f2328>(</span><span style=color:#1f2328>angle</span><span style=color:#1f2328>));</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=css-typed-object-model-support>CSS Typed Object Model Support</h3><p>目前僅有 Chrome 66 版本支援 CSS Typed OM，所以如果想要切換 CSSOM 和 CSS Typed OM 使用，可以透過以下方式來進行支援性判斷：</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>if</span> <span style=color:#1f2328>(</span><span style=color:#6639ba>window</span><span style=color:#1f2328>.</span><span style=color:#1f2328>CSS</span> <span style=color:#0550ae>&amp;&amp;</span> <span style=color:#1f2328>CSS</span><span style=color:#1f2328>.</span><span style=color:#1f2328>number</span><span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>  <span style=color:#57606a>// Supports CSS Typed OM.
</span></span></span><span style=display:flex><span><span style=color:#1f2328>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=css-typed-object-model-with-web-animation-api>CSS Typed Object Model with Web Animation API</h2><p>這種新型的 CSS Style 寫法也可以使用在 Web Animation API 上，同樣地讓開發者更好撰寫所要的樣式控制。</p><p>example</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>animate</span> <span style=color:#0550ae>=</span> <span style=color:#1f2328>el</span><span style=color:#1f2328>.</span><span style=color:#1f2328>animate</span><span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>transform</span><span style=color:#0550ae>:</span> <span style=color:#1f2328>[</span>
</span></span><span style=display:flex><span>    <span style=color:#57606a>// &#39;rotate(0deg)&#39;
</span></span></span><span style=display:flex><span>    <span style=color:#cf222e>new</span> <span style=color:#1f2328>CSSRotate</span><span style=color:#1f2328>(</span><span style=color:#0550ae>0</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>0</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>1</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>CSS</span><span style=color:#1f2328>.</span><span style=color:#1f2328>deg</span><span style=color:#1f2328>(</span><span style=color:#0550ae>0</span><span style=color:#1f2328>)),</span> 
</span></span><span style=display:flex><span>    <span style=color:#57606a>// &#39;rotate(360deg)&#39;
</span></span></span><span style=display:flex><span>    <span style=color:#cf222e>new</span> <span style=color:#1f2328>CSSRotate</span><span style=color:#1f2328>(</span><span style=color:#0550ae>0</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>0</span><span style=color:#1f2328>,</span> <span style=color:#0550ae>1</span><span style=color:#1f2328>,</span> <span style=color:#1f2328>CSS</span><span style=color:#1f2328>.</span><span style=color:#1f2328>deg</span><span style=color:#1f2328>(</span><span style=color:#0550ae>360</span><span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>   <span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>},</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>duration</span><span style=color:#0550ae>:</span> <span style=color:#0550ae>3000</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>iterations</span><span style=color:#0550ae>:</span> <span style=color:#cf222e>Infinity</span>
</span></span><span style=display:flex><span>  <span style=color:#1f2328>});</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>animate</span><span style=color:#1f2328>.</span><span style=color:#1f2328>play</span><span style=color:#1f2328>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=結論>結論</h2><p><code>CSS Typed Object Model</code> 主要目的是在解決以往使用 JavaScript 操作 CSSOM 時所需要耗費的解析成本，以及透過更直接的操作 property object 來提升開發便利性。目前雖然支援性不高，不過還是希望以後能都使用這種方式來操作 CSS，畢竟傳統的方式對於開發者來說確實不太方便～</p><h2 id=reference>Reference</h2><ol><li><a href=https://developers.google.com/web/updates/2018/03/cssom>Working with the new CSS Typed Object Model</a></li><li><a href=https://drafts.css-houdini.org/css-typed-om/#dom-element-computedstylemap>CSS Typed OM Level 1</a></li></ol></div><footer class=post-footer><div class=post-nav><a href=https://yushuanhsieh.github.io/posts/2018-06-23-browser-render-engine/ class="post-nav-link prev"><span class=label>← Previous</span>
<span class=title>The Main Flow of Rendering Engines</span>
</a><a href=https://yushuanhsieh.github.io/posts/2018-07-15-redux-anti-pattern/ class="post-nav-link next"><span class=label>Next →</span>
<span class=title>Redux Anti Pattern</span></a></div></footer></article></main><footer class=site-footer><div class=footer-inner><p class=footer-copyright>&copy; 2026 Cherie's Tech Blog. All rights reserved.</p><p class=footer-powered>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></p></div></footer></body></html>