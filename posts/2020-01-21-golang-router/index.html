<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A technical blog about software engineering, system design, and modern development practices."><meta name=author content="Cherie Hsieh"><title>Go HTTP Routers - Chi/Echo/Gin/gorilla mux 實作細節與比較 — Cherie's Tech Blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href="/css/style.css?v=1771496292"></head><body><header class=site-header><div class=header-inner><a href=https://yushuanhsieh.github.io/ class=site-logo><span class=logo-icon>⟨/⟩</span>
<span class=logo-text>Cherie's Tech Blog</span></a><nav class=site-nav><a href=/ class=nav-link>Home</a>
<a href=/posts/ class=nav-link>Posts</a>
<a href=/categories/ class=nav-link>Categories</a>
<a href=/about/ class=nav-link>About</a></nav><button class=mobile-menu-toggle aria-label="Toggle menu">
<span></span>
<span></span>
<span></span></button></div></header><main class=site-main><article class=single-post><header class=post-header><h1 class=post-title>Go HTTP Routers - Chi/Echo/Gin/gorilla mux 實作細節與比較</h1><div class=post-meta><time datetime=2020-01-21>January 21, 2020</time>
<span class=separator>·</span>
<span class=reading-time>13 min read</span></div><div class=post-categories><a href=https://yushuanhsieh.github.io/categories/go/>Go</a></div></header><nav class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#問題>問題</a></li><li><a href=#chi>Chi</a></li><li><a href=#echo>Echo</a></li><li><a href=#gin>gin</a></li><li><a href=#gorillamux>gorilla/mux</a></li><li><a href=#補充context-pool>補充：Context Pool</a></li><li><a href=#benchmark>Benchmark</a></li></ul></nav></nav><div class=post-content><h2 id=前言>前言</h2><p>之前做 API server，制定 route path 時有遇到一些問題，於是就順手看了幾個 HTTP router / web framework 的 router 部分實作方式，並且記錄下來，提供給大家做個參考。</p><h2 id=問題>問題</h2><p>需要加入</p><ol><li>/stations/instances</li><li>/stations/{id}</li></ol><p>這兩個 path 對應到不同的 handlers。</p><h2 id=chi>Chi</h2><p>package <code>github.com/go-chi/chi</code></p><p>知名 HTTP router library <code>chi</code>，其輕量、快速、handler 使用原生 <code>net/http</code> struct，都是不錯的優勢。和多數主流的 HTTP router 相似，chi 的 router 是採用 <a href=https://en.wikipedia.org/wiki/Radix_tree>radix tree</a> 結構，比較特別的是 chi 將 node type 分成四種：</p><ol><li>ntStatic (<code>/home</code>)</li><li>ntRegexp (<code>/{id:[0-9]+}</code>)</li><li>ntParam (<code>/{user}</code>)</li><li>ntCatchAll (<code>/api/v1/</code>)</li></ol><p>與其他 router 相較起來，多了 <code>Regexp</code> 這個 type，而在插入新的 node 時候，會根據 type 來將 node 插入到適當的位置。</p><p>假設我們要插入兩個 path：</p><ol><li><code>/stations/instances</code></li><li><code>/stations/{id}</code></li></ol><p>其樹狀圖如下：</p><p>![study]({{ site.url }}/assets/images/router-chi.png)</p><p>為什麼要將 nodes 分類插入呢？因為就 path match 的嚴謹程度而言是 Static > Regexp > Param > CatchAll，因此如果先分類好， router 在進行尋找的時候，就會先從 Static 分類 (index = 0) 開始找起，以符合使用者預期的行為。</p><p>不過這樣做也會有個小問題，就是沒有用到的 bucket 會空著。(因為 node children 是 <strong>array</strong> 型態呈現)</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#cf222e>type</span><span style=color:#fff> </span><span style=color:#1f2328>node</span><span style=color:#fff> </span><span style=color:#cf222e>struct</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#57606a>// node type: static, regexp, param, catchAll</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>typ</span><span style=color:#fff> </span><span style=color:#1f2328>nodeTyp</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#57606a>// more members</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#57606a>// child nodes should be stored in-order for iteration,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#57606a>// in groups of the node type.</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>children</span><span style=color:#fff> </span><span style=color:#1f2328>[</span><span style=color:#1f2328>ntCatchAll</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span><span style=color:#0550ae>1</span><span style=color:#1f2328>]</span><span style=color:#1f2328>nodes</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>另外一個問題是， Chi 在 search 的時候是使用 recursion 方式，這點對於效率與記憶體使用上都會有所影響。其他多數的 router 在 search tree 的時候是使用 iteration，只有在一些必要的部分才使用 recursion。</p><h2 id=echo>Echo</h2><p>package <code>github.com/labstack/echo/v4</code></p><p>echo 是蠻老牌的 web framework，在 2015 年第一次釋出正式版本，目前已來到 V4 版本。同樣地，echo 的 router 結構也是採用 radix tree ，不過在表現上和 chi 略有些差異。</p><p>echo 的 node type 只有三種：</p><ol><li>skind (static)</li><li>pkind (params)</li><li>akind (any)</li></ol><p>缺少 Regexp type，因此 chi 相對來說，在 route path 設定上更豐富一些 。再來看一下插入 path 時的樹狀圖：</p><ol><li><code>/stations/instances</code></li><li><code>/stations/{id}</code></li></ol><p>![study]({{ site.url }}/assets/images/router-echo.png)</p><p>echo 的 node children 是 <strong>slice</strong> 型態，而 slice 內的 node 順序是根據插入先後來決定的，當要尋找 node 的時候，echo 也是會按照 skind > pkind > akind 的順序去找，不過由於 children 插入時並沒有預先分類，因此必須要 loop children 篩選出 type priority 高的 node，這裡是與 chi 明顯的差異處。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#57606a>// from echo/router.go</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#cf222e>type</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>node</span><span style=color:#fff> </span><span style=color:#cf222e>struct</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>kind</span><span style=color:#fff>          </span><span style=color:#1f2328>kind</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>label</span><span style=color:#fff>         </span><span style=color:#cf222e>byte</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>prefix</span><span style=color:#fff>        </span><span style=color:#cf222e>string</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>parent</span><span style=color:#fff>        </span><span style=color:#0550ae>*</span><span style=color:#1f2328>node</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>children</span><span style=color:#fff>      </span><span style=color:#1f2328>children</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>ppath</span><span style=color:#fff>         </span><span style=color:#cf222e>string</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>pnames</span><span style=color:#fff>        </span><span style=color:#1f2328>[]</span><span style=color:#cf222e>string</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>methodHandler</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>methodHandler</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>kind</span><span style=color:#fff>          </span><span style=color:#cf222e>uint8</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>children</span><span style=color:#fff>      </span><span style=color:#1f2328>[]</span><span style=color:#0550ae>*</span><span style=color:#1f2328>node</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>但即使如此，整體上 echo 的 search algorithm 還是寫的很不錯，在 Benchmark 上有優異的表現。</p><h2 id=gin>gin</h2><p>package <code>github.com/gin-gonic/gin</code></p><p>同樣為老牌 web framework，gin 最為人所知的就是 router 的速度快，當然要快的話肯定也是基於 radix tree 所組成。</p><p>gin 的 node type 大同小異也是三種：</p><ol><li>static</li><li>params</li><li>catchAll</li></ol><p>但與上面兩個 router 設計不同的是，gin 在插入 node 會有一些限制，例如上面的例子：</p><ol><li><code>/stations/instances</code></li><li><code>/stations/:id</code></li></ol><p>![study]({{ site.url }}/assets/images/router-gin.png)</p><p>gin 不允許這樣的 path 設計，其原因 node 中有一個 <code>wildChild</code> member 是用來進行搜尋判斷，而當插入含有 params path 時，這個 wildChild 會被設定成 true，進而導致同一層的 static path child 會變成 unreachable 狀態。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#cf222e>type</span><span style=color:#fff> </span><span style=color:#1f2328>node</span><span style=color:#fff> </span><span style=color:#cf222e>struct</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>path</span><span style=color:#fff>      </span><span style=color:#cf222e>string</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>indices</span><span style=color:#fff>   </span><span style=color:#cf222e>string</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>children</span><span style=color:#fff>  </span><span style=color:#1f2328>[]</span><span style=color:#0550ae>*</span><span style=color:#1f2328>node</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>handlers</span><span style=color:#fff>  </span><span style=color:#1f2328>HandlersChain</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>priority</span><span style=color:#fff>  </span><span style=color:#cf222e>uint32</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>nType</span><span style=color:#fff>     </span><span style=color:#1f2328>nodeType</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>maxParams</span><span style=color:#fff> </span><span style=color:#cf222e>uint8</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>wildChild</span><span style=color:#fff> </span><span style=color:#cf222e>bool</span><span style=color:#fff> </span><span style=color:#57606a>// wildcard path</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>fullPath</span><span style=color:#fff>  </span><span style=color:#cf222e>string</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>此外，今天假設我們有些 path 需求，例如：</p><ol><li><code>student/:id</code></li><li><code>student/others/:id</code></li></ol><p>如果要兼容 gin 本身的限制，就要將 path 設定成：</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#1f2328>router</span><span style=color:#1f2328>.</span><span style=color:#6639ba>GET</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/student/:id&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>StudentHandler</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>router</span><span style=color:#1f2328>.</span><span style=color:#6639ba>GET</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/student/:id/:others&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>OtherHandler</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>這樣就能夠根據不同的 path 來進入到對應的 handler 了。</p><h2 id=gorillamux>gorilla/mux</h2><p>package <code>github.com/gorilla/mux</code></p><p>以上幾個 router 都是採用 radix tree，所以最後來介紹一個很常見，但是採用單純 matcher list 設計的 <code>gorilla/mux</code>。</p><p>當我們在加入新的 path 時，gorilla mux 會將其新增到 routes slice 上，順序採用加入先後排列。</p><p>![study]({{ site.url }}/assets/images/router-mux.png)</p><p>(Note: route 中其實有 matchers list，可以結合不同種類的 matcher，例如 headerMatcher, schemeMatcher 等)</p><p>在搜尋適合的 route 時候，會從第一個開始匹配，也就是說即使我們要找的 path 是 <code>/stations/instances</code> ，但是由於第一個 route 的 matcher 已經符合，所以就不會繼續比對到下一個更精確的 route。</p><p>因此也可以知道，gorilla mux 在搜尋上的速度一定是較慢，但可以搭配想要的 matcher，彈性也是蠻高的。</p><h2 id=補充context-pool>補充：Context Pool</h2><p>除了 path 搜尋速度之外，各大 router libraries 也會針對 context 做額外的效能提升。最明顯的就是使用 <code>sync.Pool</code> 來避免當每個 request 進來的時候，需要新建立一個 context 給 handler 使用。當短時間有大量 request 進出時，如果動態分配太多 context，會造成 Garbage Collection 的壓力，進而觸發清理而影響效能。使用 <code>sync.Pool</code> 的好處是可以重複使用閒置的 context，以減少此類問題發生。</p><p>以 Echo source code 為例，可以看到 context 從 pool 中取出和放回。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#cf222e>func</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#1f2328>e</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>Echo</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#6639ba>ServeHTTP</span><span style=color:#1f2328>(</span><span style=color:#1f2328>w</span><span style=color:#fff> </span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>ResponseWriter</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>r</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Request</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#57606a>// Acquire context</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>c</span><span style=color:#fff> </span><span style=color:#0550ae>:=</span><span style=color:#fff> </span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>pool</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Get</span><span style=color:#1f2328>().(</span><span style=color:#0550ae>*</span><span style=color:#1f2328>context</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>c</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Reset</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>w</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#0550ae>:=</span><span style=color:#fff> </span><span style=color:#1f2328>NotFoundHandler</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>premiddleware</span><span style=color:#fff> </span><span style=color:#0550ae>==</span><span style=color:#fff> </span><span style=color:#cf222e>nil</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#6639ba>findRouter</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Host</span><span style=color:#1f2328>).</span><span style=color:#6639ba>Find</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Method</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#6639ba>getPath</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>),</span><span style=color:#fff> </span><span style=color:#1f2328>c</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#1f2328>=</span><span style=color:#fff> </span><span style=color:#1f2328>c</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Handler</span><span style=color:#1f2328>()</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#1f2328>=</span><span style=color:#fff> </span><span style=color:#6639ba>applyMiddleware</span><span style=color:#1f2328>(</span><span style=color:#1f2328>h</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>middleware</span><span style=color:#0550ae>...</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>else</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#1f2328>=</span><span style=color:#fff> </span><span style=color:#cf222e>func</span><span style=color:#1f2328>(</span><span style=color:#1f2328>c</span><span style=color:#fff> </span><span style=color:#1f2328>Context</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#cf222e>error</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>			</span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#6639ba>findRouter</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Host</span><span style=color:#1f2328>).</span><span style=color:#6639ba>Find</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Method</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#6639ba>getPath</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#1f2328>),</span><span style=color:#fff> </span><span style=color:#1f2328>c</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>			</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#0550ae>:=</span><span style=color:#fff> </span><span style=color:#1f2328>c</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Handler</span><span style=color:#1f2328>()</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>			</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#1f2328>=</span><span style=color:#fff> </span><span style=color:#6639ba>applyMiddleware</span><span style=color:#1f2328>(</span><span style=color:#1f2328>h</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>middleware</span><span style=color:#0550ae>...</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>			</span><span style=color:#cf222e>return</span><span style=color:#fff> </span><span style=color:#6639ba>h</span><span style=color:#1f2328>(</span><span style=color:#1f2328>c</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>h</span><span style=color:#fff> </span><span style=color:#1f2328>=</span><span style=color:#fff> </span><span style=color:#6639ba>applyMiddleware</span><span style=color:#1f2328>(</span><span style=color:#1f2328>h</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>premiddleware</span><span style=color:#0550ae>...</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#57606a>// Execute chain</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#1f2328>err</span><span style=color:#fff> </span><span style=color:#0550ae>:=</span><span style=color:#fff> </span><span style=color:#6639ba>h</span><span style=color:#1f2328>(</span><span style=color:#1f2328>c</span><span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#1f2328>err</span><span style=color:#fff> </span><span style=color:#0550ae>!=</span><span style=color:#fff> </span><span style=color:#cf222e>nil</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#6639ba>HTTPErrorHandler</span><span style=color:#1f2328>(</span><span style=color:#1f2328>err</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>c</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#57606a>// Release context</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>pool</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Put</span><span style=color:#1f2328>(</span><span style=color:#1f2328>c</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>另外， Echo 更有趣的地方是，它在新建 context 的時候，會建立一個可以容納最大 params 數的 string slice(<code>pvalues</code>)，這樣就可以將 params 值放入 context 而不觸發 slice expansion。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#cf222e>func</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#1f2328>e</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>Echo</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#6639ba>NewContext</span><span style=color:#1f2328>(</span><span style=color:#1f2328>r</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Request</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>w</span><span style=color:#fff> </span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>ResponseWriter</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>Context</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#cf222e>return</span><span style=color:#fff> </span><span style=color:#0550ae>&amp;</span><span style=color:#1f2328>context</span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>request</span><span style=color:#1f2328>:</span><span style=color:#fff>  </span><span style=color:#1f2328>r</span><span style=color:#1f2328>,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>response</span><span style=color:#1f2328>:</span><span style=color:#fff> </span><span style=color:#6639ba>NewResponse</span><span style=color:#1f2328>(</span><span style=color:#1f2328>w</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>e</span><span style=color:#1f2328>),</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>store</span><span style=color:#1f2328>:</span><span style=color:#fff>    </span><span style=color:#6639ba>make</span><span style=color:#1f2328>(</span><span style=color:#1f2328>Map</span><span style=color:#1f2328>),</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>echo</span><span style=color:#1f2328>:</span><span style=color:#fff>     </span><span style=color:#1f2328>e</span><span style=color:#1f2328>,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>pvalues</span><span style=color:#1f2328>:</span><span style=color:#fff>  </span><span style=color:#6639ba>make</span><span style=color:#1f2328>([]</span><span style=color:#cf222e>string</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>e</span><span style=color:#1f2328>.</span><span style=color:#1f2328>maxParam</span><span style=color:#1f2328>),</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>		</span><span style=color:#1f2328>handler</span><span style=color:#1f2328>:</span><span style=color:#fff>  </span><span style=color:#1f2328>NotFoundHandler</span><span style=color:#1f2328>,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>Chi 則是有使用 sync.Pool，不過 context 的 params 會是一個 0 size 的 string slice，而在需要放入 params 值再使用 <code>append</code> 來插入到 params slice。雖然可能會觸發 slice expansion，不過如果 params 數很少，是不太會有明顯地效能影響。</p><p>有一點要特別注意的是，<code>sync.Pool</code> 不是每個場景都很適用的，例如：它會在 GC trigger 時候，把 pool 內的 object 清除，因此不適合放需要長時間保留的 object。還有就是即使使用 <code>sync.Pool</code> 也有可能降低效能，可以參考 <a href=https://medium.com/a-journey-with-go/go-understand-the-design-of-sync-pool-2dde3024e277>Go: Understand the Design of Sync.Pool</a>，文章中有例子講解和實作原理。</p><h2 id=benchmark>Benchmark</h2><p>最後不可免俗地跑個 Benchmark，基於 <a href=https://github.com/julienschmidt/go-http-routing-benchmark>julienschmidt/go-http-routing-benchmark</a> 所測試的結果。老實說 Chi 的表現有點出乎我意料，除了 recursion 因素之外，推測還與 context reuse 方式有關，可參考 <a href=https://github.com/go-chi/chi/blob/master/tree.go#L374>chi/tree.go</a>。</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span>BenchmarkChi_Param               	 <span style=color:#0550ae>2000000</span>	       <span style=color:#0550ae>916</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_Param              	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>67.1</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_Param               	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>73.0</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_Param        	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2239</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1280</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_Param5              	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1215</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_Param5             	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>155</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_Param5              	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>143</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_Param5       	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>3130</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1344</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_Param20             	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>2009</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_Param20            	 <span style=color:#0550ae>3000000</span>	       <span style=color:#0550ae>487</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_Param20             	 <span style=color:#0550ae>5000000</span>	       <span style=color:#0550ae>382</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_Param20      	  <span style=color:#0550ae>200000</span>	      <span style=color:#0550ae>7037</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>3451</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>12</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_ParamWrite          	 <span style=color:#0550ae>2000000</span>	       <span style=color:#0550ae>969</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_ParamWrite         	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>144</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>8</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>1</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_ParamWrite          	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>121</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_ParamWrite   	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>2269</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1280</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GithubStatic        	 <span style=color:#0550ae>2000000</span>	       <span style=color:#0550ae>848</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GithubStatic       	<span style=color:#0550ae>20000000</span>	       <span style=color:#0550ae>100</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GithubStatic        	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>88.8</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GithubStatic 	  <span style=color:#0550ae>100000</span>	     <span style=color:#0550ae>11857</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>976</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>9</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GithubParam         	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1241</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GithubParam        	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>182</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GithubParam         	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>186</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GithubParam  	  <span style=color:#0550ae>200000</span>	      <span style=color:#0550ae>7122</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1296</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GithubAll           	    <span style=color:#0550ae>5000</span>	    <span style=color:#0550ae>260724</span> ns<span style=color:#0550ae>/</span>op	   <span style=color:#0550ae>87697</span> B<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>609</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GithubAll          	   <span style=color:#0550ae>50000</span>	     <span style=color:#0550ae>36859</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GithubAll           	   <span style=color:#0550ae>50000</span>	     <span style=color:#0550ae>39361</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GithubAll    	     <span style=color:#0550ae>300</span>	   <span style=color:#0550ae>3869867</span> ns<span style=color:#0550ae>/</span>op	  <span style=color:#0550ae>251672</span> B<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1994</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GPlusStatic         	 <span style=color:#0550ae>2000000</span>	       <span style=color:#0550ae>875</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GPlusStatic        	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>64.3</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GPlusStatic         	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>63.2</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GPlusStatic  	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1865</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>976</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>9</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GPlusParam          	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1013</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GPlusParam         	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>97.1</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GPlusParam          	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>125</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GPlusParam   	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2998</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1280</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GPlus2Params        	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1146</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GPlus2Params       	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>148</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GPlus2Params        	<span style=color:#0550ae>10000000</span>	       <span style=color:#0550ae>177</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GPlus2Params 	  <span style=color:#0550ae>300000</span>	      <span style=color:#0550ae>5355</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1296</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_GPlusAll            	  <span style=color:#0550ae>100000</span>	     <span style=color:#0550ae>14494</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>5616</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>39</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_GPlusAll           	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1602</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_GPlusAll            	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1702</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_GPlusAll     	   <span style=color:#0550ae>30000</span>	     <span style=color:#0550ae>47365</span> ns<span style=color:#0550ae>/</span>op	   <span style=color:#0550ae>16112</span> B<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>128</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_ParseStatic         	 <span style=color:#0550ae>2000000</span>	       <span style=color:#0550ae>850</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_ParseStatic        	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>63.3</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_ParseStatic         	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>66.7</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_ParseStatic  	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2589</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>976</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>9</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_ParseParam          	 <span style=color:#0550ae>2000000</span>	       <span style=color:#0550ae>972</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_ParseParam         	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>79.3</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_ParseParam          	<span style=color:#0550ae>20000000</span>	        <span style=color:#0550ae>81.2</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_ParseParam   	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2590</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1280</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_Parse2Params        	 <span style=color:#0550ae>1000000</span>	      <span style=color:#0550ae>1068</span> ns<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>432</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>3</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_Parse2Params       	<span style=color:#0550ae>20000000</span>	       <span style=color:#0550ae>106</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_Parse2Params        	<span style=color:#0550ae>20000000</span>	       <span style=color:#0550ae>111</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_Parse2Params 	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2695</span> ns<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1296</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>10</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_ParseAll            	   <span style=color:#0550ae>50000</span>	     <span style=color:#0550ae>27547</span> ns<span style=color:#0550ae>/</span>op	   <span style=color:#0550ae>11232</span> B<span style=color:#0550ae>/</span>op	      <span style=color:#0550ae>78</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_ParseAll           	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2681</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_ParseAll            	  <span style=color:#0550ae>500000</span>	      <span style=color:#0550ae>2977</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_ParseAll     	   <span style=color:#0550ae>20000</span>	     <span style=color:#0550ae>97551</span> ns<span style=color:#0550ae>/</span>op	   <span style=color:#0550ae>30289</span> B<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>250</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkChi_StaticAll           	   <span style=color:#0550ae>10000</span>	    <span style=color:#0550ae>158210</span> ns<span style=color:#0550ae>/</span>op	   <span style=color:#0550ae>67825</span> B<span style=color:#0550ae>/</span>op	     <span style=color:#0550ae>471</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkEcho_StaticAll          	  <span style=color:#0550ae>100000</span>	     <span style=color:#0550ae>23191</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGin_StaticAll           	  <span style=color:#0550ae>100000</span>	     <span style=color:#0550ae>22989</span> ns<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> B<span style=color:#0550ae>/</span>op	       <span style=color:#0550ae>0</span> allocs<span style=color:#0550ae>/</span>op
</span></span><span style=display:flex><span>BenchmarkGorillaMux_StaticAll    	    <span style=color:#0550ae>1000</span>	   <span style=color:#0550ae>1155625</span> ns<span style=color:#0550ae>/</span>op	  <span style=color:#0550ae>153240</span> B<span style=color:#0550ae>/</span>op	    <span style=color:#0550ae>1413</span> allocs<span style=color:#0550ae>/</span>op
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><div class=post-nav><a href=https://yushuanhsieh.github.io/posts/2020-01-19-memory-allocator-implicit-free-list/ class="post-nav-link prev"><span class=label>← Previous</span>
<span class=title>Implement Memory Allocator - Implicit Free List</span>
</a><a href=https://yushuanhsieh.github.io/posts/2020-02-24-february/ class="post-nav-link next"><span class=label>Next →</span>
<span class=title>2月雜談</span></a></div></footer></article></main><footer class=site-footer><div class=footer-inner><p class=footer-copyright>&copy; 2026 Cherie's Tech Blog. All rights reserved.</p><p class=footer-powered>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></p></div></footer></body></html>