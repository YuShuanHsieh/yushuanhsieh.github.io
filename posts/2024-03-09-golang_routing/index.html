<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A technical blog about software engineering, system design, and modern development practices."><meta name=author content="Cherie Hsieh"><title>å¾ Golang 1.22 routing enhancement çœ‹å°ˆæ¡ˆé–‹ç™¼ â€” Cherie's Tech Blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href="/css/style.css?v=1771496292"></head><body><header class=site-header><div class=header-inner><a href=https://yushuanhsieh.github.io/ class=site-logo><span class=logo-icon>âŸ¨/âŸ©</span>
<span class=logo-text>Cherie's Tech Blog</span></a><nav class=site-nav><a href=/ class=nav-link>Home</a>
<a href=/posts/ class=nav-link>Posts</a>
<a href=/categories/ class=nav-link>Categories</a>
<a href=/about/ class=nav-link>About</a></nav><button class=mobile-menu-toggle aria-label="Toggle menu">
<span></span>
<span></span>
<span></span></button></div></header><main class=site-main><article class=single-post><header class=post-header><h1 class=post-title>å¾ Golang 1.22 routing enhancement çœ‹å°ˆæ¡ˆé–‹ç™¼</h1><div class=post-meta><time datetime=2024-03-08>March 8, 2024</time>
<span class=separator>Â·</span>
<span class=reading-time>10 min read</span></div><div class=post-categories><a href=https://yushuanhsieh.github.io/categories/go/>Go</a></div></header><div class=post-content><p>é€™æ¬¡ Golang 1.22 ç‰ˆæœ¬é‡å°å…§å»ºçš„ http.ServeMux (HTTP request multiplexer) é€²è¡Œæ”¹å–„ï¼ŒåŸæœ¬ http.ServeMux çš„è¨­è¨ˆåŠ›æ±‚ç›´è¦ºå–®ç´”ï¼Œé©ç”¨åœ¨æ¶è¨­ç°¡å–® HTTP server çš„æ‡‰ç”¨å ´æ™¯ï¼›ä½†éš¨è‘— RESTful API æˆç‚ºç›®å‰ HTTP-based interface è¨­è¨ˆä¸»æµï¼Œè€Œæ—¢æœ‰çš„ http.ServeMux ä¸¦æ²’æœ‰è¾¦æ³•å¯¦ä½œ RESTful APIï¼Œå°è‡´å…§å»ºçš„ http.ServeMux ä½¿ç”¨æ™‚æ©Ÿæ„ˆä¾†æ„ˆå°‘ï¼ŒGopher å¿…é ˆä»°è³´ç¬¬ä¸‰æ–¹å¥—ä»¶æ‰èƒ½å¯¦ç¾ RESTful APIã€‚ç‚ºäº†æ”¹å–„æ­¤å•é¡Œï¼ŒGolang 1.22 åŠ å¼·äº† http.ServeMux çš„ routing è¨­è¨ˆï¼Œé™¤äº†èƒ½å¤ è¾¨åˆ¥ HTTP method ä¹‹å¤–ï¼Œä¹Ÿå¢åŠ äº†å‹•æ…‹è·¯å¾‘ wildcard çš„åŠŸèƒ½ï¼Œä½¿ http.ServeMux èƒ½å¤ æ»¿è¶³å¯¦å‹™ä¸ŠåŸºæœ¬ HTTP server çš„éœ€æ±‚ã€‚</p><p>å¦‚æœå–®ç´”å¾é–‹ç™¼è§’åº¦ä¾†çœ‹ï¼Œä¿®æ”¹ http.ServeMux çš„ routing å¯¦ä½œçœ‹èµ·ä¾†ä¸æœƒæ˜¯å€‹å¤ªå›°é›£çš„ä»»å‹™ï¼Œä½†æ˜¯è€ƒæ…®åˆ°æ—¢æœ‰ç”¨æˆ¶ç›¸å®¹ã€è¨­è¨ˆç†å¿µã€è·¯å¾‘åˆ¤æ–·æ©Ÿåˆ¶ç­‰ï¼ŒåŸæœ¬çœ‹ä¼¼ç°¡å–®çš„é …ç›®ï¼Œå¯¦éš›ä¸Šä¹Ÿéœ€è¦å„æ–¹é¢çš„è€ƒé‡ã€‚æ‰€ä»¥é€™ç¯‡æ–‡ç« ä¸»è¦åœ¨å½™æ•´ proposal issue ä¸Šçš„æƒ³æ³•å’Œå…§å®¹ï¼Œè®“æˆ‘å€‘å¯ä»¥é€²ä¸€æ­¥æ€è€ƒï¼Œé€™äº›è¨è«–æ–¹å‘å’Œæ€è€ƒé¢å‘èƒ½å¦æ‡‰ç”¨åœ¨å·¥ä½œçš„å°ˆæ¡ˆä¸­ï¼Œä½¿å¾—å°ˆæ¡ˆåœ¨é–‹ç™¼æ™‚å¯ä»¥æ›´åŠ å®Œå–„ã€‚</p><p><a href=https://go.dev/blog/routing-enhancements>Routing Enhancements for Go 1.22</a></p><h2 id=ææ¡ˆå’Œå‹•æ©Ÿ>ææ¡ˆå’Œå‹•æ©Ÿ</h2><div class=info-block>ğŸ“– We would like to expand the standard HTTP mux's capabilities by adding two features:<br>1. distinguishing requests based on HTTP method (GET, POST, ...)<br>2. support for wildcards in the matched paths.<br>Both features are particularly important to REST API servers.<br><br>Adding these features to the standard library means one fewer dependency for many projects.</div><p>æ¯é …ææ¡ˆèƒŒå¾Œéƒ½å¿…é ˆè¦æœ‰ä¸€å€‹æ˜ç¢ºçš„å‹•æ©Ÿï¼Œæ­£å¦‚ä¸€é–‹å§‹æ‰€æåŠï¼Œéå¾€çš„ http.ServeMux åŠŸèƒ½éæ–¼é™½æ˜¥ï¼Œåœ¨ RESTful API æ¦‚å¿µæ™®åŠçš„æƒ…æ³ä¸‹ï¼Œå…§å»ºçš„ http.ServeMux å¯¦éš›èƒ½æ‡‰ç”¨åœ¨å°ˆæ¡ˆä¸Šçš„ç¯„åœå¾ˆæœ‰é™ï¼Œç„¡æ³•æ”¯æ´å¸¸è¦‹çš„ CRUD å ´æ™¯ï¼ˆç•¢ç«Ÿç¾åœ¨è«‡åˆ° CRUD å°±å¾ˆè‡ªç„¶åœ°è¯æƒ³åˆ°çµåˆ GET, POST, PUT ç­‰ HTTP method æ‰€ç”¢ç”Ÿçš„ endpointï¼‰ï¼Œé ‚å¤šç”¨åœ¨æ•™å­¸ã€æä¾› metricsã€æˆ–æ˜¯ health ç­‰å–®ä¸€ç”¨é€”çš„æ™‚å€™ã€‚</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#57606a>// before go 1.22</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#57606a>// requests with /health path will route to it regardless of the HTTP method</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#6639ba>HandleFunc</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/health&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#cf222e>func</span><span style=color:#1f2328>(</span><span style=color:#1f2328>resp</span><span style=color:#fff> </span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>ResponseWriter</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>req</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Request</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#1f2328>fmt</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Fprintf</span><span style=color:#1f2328>(</span><span style=color:#1f2328>resp</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;healthy&#34;</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>})</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><p>å› æ­¤ï¼Œææ¡ˆçš„å…§å®¹å°±æ˜¯æ–°å¢ HTTP method çš„åˆ¤æ–·å’Œåœ¨è·¯å¾‘ä¸­å¢åŠ  wildcard ä»¥æ”¯æ´ path parameter è¨­å®šï¼Œå¦‚æ­¤ä¸€ä¾†å°±èƒ½ç¬¦åˆå¯¦ä½œ RESTful API çš„åŸºæœ¬éœ€æ±‚ã€‚</p><div class=highlight><div style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#57606a>// go 1.22</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#57606a>// requests with GET method and /user/* path will route to it</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#6639ba>HandleFunc</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;GET /user/{name}&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#cf222e>func</span><span style=color:#1f2328>(</span><span style=color:#1f2328>resp</span><span style=color:#fff> </span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>ResponseWriter</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>req</span><span style=color:#fff> </span><span style=color:#0550ae>*</span><span style=color:#1f2328>http</span><span style=color:#1f2328>.</span><span style=color:#1f2328>Request</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>param</span><span style=color:#fff> </span><span style=color:#0550ae>:=</span><span style=color:#fff> </span><span style=color:#1f2328>r</span><span style=color:#1f2328>.</span><span style=color:#6639ba>PathValue</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;name&#34;</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	  </span><span style=color:#1f2328>fmt</span><span style=color:#1f2328>.</span><span style=color:#6639ba>Fprintf</span><span style=color:#1f2328>(</span><span style=color:#1f2328>resp</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;user name is %s&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#1f2328>name</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>	</span><span style=color:#1f2328>})</span><span style=color:#fff>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=è¨­è¨ˆç†å¿µ>è¨­è¨ˆç†å¿µ</h2><p>ææ¡ˆä¸­çš„å…©é …åŠŸèƒ½ï¼Œè¡¨é¢ä¸Šçœ‹èµ·ä¾†å¾ˆç°¡å–®ï¼Œä½†æ˜¯å¯¦éš›ä¸Šå»æ˜¯æœ‰è‘—ä¸åŒé¢å‘çš„è€ƒé‡ï¼Œé€™ä¹Ÿæ˜¯æˆ‘è¦ºå¾—å¾ˆæœ‰æ„æ€çš„åœ°æ–¹ã€‚å…¶ä¸­ä¸€å€‹å°±æ˜¯è²«å¾¹ http.ServeMux åŸå…ˆçš„è¨­è¨ˆç†å¿µï¼š</p><div class=info-block>ğŸ“– It remains a key design goal to avoid any semantics that depend on registration order.</div><p>ç•¶æˆ‘å€‘åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ HTTP routing æˆ–æ˜¯ web frameworkï¼Œæœ‰æ™‚å€™æœƒç™¼ç¾ matched åˆ°çš„ handler æœƒåŸºæ–¼ handler çš„è¨»å†Šé †åºï¼Œä¾‹å¦‚ä»¥ä¸‹ä¾‹å­ï¼š</p><ol><li>/news/{news_id}</li><li>/news/latest</li></ol><p>å‡è¨­ framework å…è¨±é€™æ¨£è¨»å†Šè¡Œç‚ºï¼Œé‚£éº¼å…ˆè¨»å†Šç¬¬ä¸€å€‹å†è¨»å†ŠäºŒå€‹ï¼Œæœ‰å¯èƒ½å°±æœƒå°è‡´ <code>/news/*</code> çš„ request éƒ½èµ°ç¬¬ä¸€å€‹è¨»å†Šçš„ handler è€Œä¸æœƒèµ°åˆ°ç¬¬äºŒå€‹ã€‚å¦‚æœä½¿ç”¨è€…å¸Œæœ› <code>/news/latest</code> çš„ request èƒ½æ­£ç¢ºèµ°åˆ°ç¬¬äºŒå€‹ handlerï¼Œé‚£å°±å¿…é ˆè¦è‡ªå·±èª¿æ•´è¨»å†Šé †åºï¼Œå…ˆè¨»å†Šç¬¬äºŒå€‹å†è¨»å†Šç¬¬ä¸€å€‹ï¼Œé€™æ¨£åœ¨ match ä¸åˆ° <code>/news/latest</code> çš„ request æ‰æœƒè¢«å°å‘ <code>/news/{news_id}</code>ã€‚</p><p>è€Œ Golang http.ServeMux çš„è¨­è¨ˆæ–¹å‘æ˜¯å¸Œæœ›èƒ½å¤ ä¸è¦ä¾è³´æ–¼è¨»å†Šé †åºï¼Œé¿å…é€ æˆä»¥ä¸Šçš„éŒ¯èª¤åˆ¤æ–·ã€‚é€™æ¬¡çš„æ”¹å–„ææ¡ˆä¸­ä¹Ÿæ˜¯åŸºæ–¼é€™æ¨£çš„ç†å¿µä¾†é€²è¡ŒåŠŸèƒ½æ“´å±•ã€‚</p><h2 id=è¨­è¨ˆç´°ç¯€routing-çš„è¦å‰‡>è¨­è¨ˆç´°ç¯€ï¼šRouting çš„è¦å‰‡</h2><p>ææ¡ˆä¸­å¸Œæœ› path èƒ½æ”¯æ´ wildcard çš„åŠŸèƒ½ï¼Œé‚£éº¼ routing è¦å‰‡è©²å¦‚ä½•åŸºæ–¼è¨­è¨ˆç†å¿µä¸¦ä¸”çµåˆ wildcard ä¾†èª¿æ•´ï¼Œå°±æœƒæ˜¯é€™å€‹åŠŸèƒ½çš„é‡é»å¯¦ä½œç´°ç¯€ã€‚ä»–å€‘è¨è«–äº†å¹¾å€‹ router å¸¸è¦‹çš„å¯¦ä½œæ–¹å¼ï¼š</p><ol><li>disallow overlaps</li><li>the pattern that was registered last</li><li>longest literal prefix</li></ol><p>åœ¨ç¶œåˆè€ƒé‡ä¹‹ä¸‹ï¼Œæ±ºå®šæ¡ç”¨ <code>the most specific pattern wins</code> çš„è¦å‰‡ï¼Œä¾‹å¦‚ï¼š</p><ol><li>/users/{u}/posts/latest (preferred)</li><li>/users/{u}/posts/{id}</li></ol><p>è·¯å¾‘ä¸­ <code>/users/{u}/posts/latest</code> æ¯”èµ· <code>/users/{u}/posts/{id}</code> çš„ match ç¯„åœæ›´å°ï¼Œæ‰€ä»¥æœƒè¢«å„ªå…ˆé¸æ“‡ï¼Œ<strong>ç„¡é—œæ–¼é€™å…©å€‹è¦å‰‡çš„è¨»å†Šé †åº</strong>ã€‚</p><ol><li>GET /posts/{id} (preferred)</li><li>/posts/{id}</li></ol><p>å¦ä¸€å€‹ä¾‹å­ï¼Œé€™å…©å€‹è¦å‰‡éƒ½èƒ½è¢«è¨»å†Šï¼Œä½†æ˜¯ 1 å› ç‚ºæœ‰é™å®š GET HTTP methodï¼Œå…¶ match ç¯„åœæ¯” 2 å°ï¼Œæ‰€ä»¥ä¹Ÿæœƒè¢«å„ªå…ˆé¸æ“‡ã€‚åŒæ¨£åœ°ï¼Œ<strong>ç„¡é—œæ–¼é€™å…©å€‹è¦å‰‡çš„è¨»å†Šé †åº</strong>ã€‚</p><p>åœ¨ <a href=https://github.com/golang/go/issues/61410>Proposal Issue</a> ä¸­æœ‰ç¹ªè£½å‡ºå¾ˆæ¸…æ¥šçš„åœ–ä¾‹ï¼Œèªªæ˜å“ªäº›è¦å‰‡æœƒè¢«é¸æ“‡ã€‚è€Œå¦‚æœåœ¨è¨»å†Šæ™‚å‡ºç¾è¦å‰‡è¡çªï¼Œå‰‡æœƒç›´æ¥ panic å‡ºéŒ¯ï¼Œé¿å…å› ç‚ºè¨»å†Šé †åºçš„å·®ç•°è€Œé€ æˆä¸å¦‚é æœŸçš„è·¯å¾‘åˆ¤æ–·ã€‚</p><h2 id=å¯¦ä½œ>å¯¦ä½œ</h2><p>è¨è«–å‡ºè¨­è¨ˆç´°ç¯€å¾Œï¼Œå°±èƒ½è½å¯¦å¯¦ä½œäº†ï¼Œå¯¦ä½œçš„ source code ä¸¦ä¸è¤‡é›œï¼ŒæŠŠ pattern æ‹†è§£æˆå„ segment ä¸¦ä¸”é€ä¸€é€²è¡Œæ¯”è¼ƒï¼Œä¾†ç¢ºèª pattern ä¹‹é–“æ˜¯å¦æœ‰è¡çªã€‚</p><p><img src=/posts/2024-03-09-golang_routing_1.png alt></p><p>è€Œåœ¨ request routing çš„æ™‚å€™ï¼ŒåŸºæ–¼ <strong>the most specific pattern wins</strong> çš„åŸå‰‡ï¼Œæœƒå…ˆæ‰¾å‡ºç¯„åœå°çš„è¦å‰‡ä¾†é€²è¡Œæ¯”å°ï¼Œå¦‚æœä¸ match å‰‡æœƒé€é backtracking æ¼”ç®—æ³•ï¼Œæ‰¾åˆ°ä¸Šä¸€å±¤ç¯„åœæ¯”è¼ƒå¤§çš„è¦å‰‡å†é€²è¡Œæ¯”å°ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œrouter ä¸­æœ‰å…©å€‹è¦å‰‡ï¼š</p><ol><li>/users/{u}/posts/latest</li><li>/users/{u}/posts/{id}</li></ol><p>ç•¶ request <code>/users/cherie/posts/1</code> è¦é€²è¡Œ match çš„æ™‚å€™ï¼Œå‰‡ç¬¬ä¸€å€‹è¦å‰‡æœƒå…ˆæ¯”å°ï¼Œç™¼ç¾ä¸ç¬¦åˆå¾Œï¼Œå†æ¯”å°ç¬¬äºŒå€‹è¦å‰‡ã€‚</p><h2 id=å½±éŸ¿>å½±éŸ¿</h2><p>é›–ç„¶åŠŸèƒ½æ“´å±•æé«˜äº†å¯¦ç”¨æ€§ï¼Œä¸éä½¿ç”¨è€…ä¹Ÿæœƒæƒ³çŸ¥é“æ–°å¢é€™å…©é …åŠŸèƒ½æ‰€é€ æˆçš„å½±éŸ¿ã€‚ææ¡ˆè€…æœ‰ç‰¹åˆ¥æåŠåˆ°ä½¿ç”¨è€…æ‰€é—œå¿ƒçš„æ•ˆèƒ½è­°é¡Œï¼Œå…¶ä¸­æ•ˆèƒ½åˆ†ç‚ºå…©éƒ¨åˆ†ï¼š</p><ol><li>request é€²ä¾†æ™‚ match çš„æ•ˆç‡</li><li>server åœ¨ä¸€é–‹å§‹å•Ÿå‹•æ™‚è¨»å†Š handlerï¼Œè¨»å†Šéç¨‹ä¸­ç™¼ç¾è¦å‰‡è¡çªçš„æ™‚é–“</li></ol><div class=info-block>ğŸ“–
The reference implementation for this proposal matches requests about as fast as the current ServeMux on Julien Schmidtâ€™s static benchmark.</div><p>é‡å°ç¬¬ä¸€å€‹æ•ˆèƒ½å•é¡Œï¼Œææ¡ˆè€…èªªæ˜ match æ•ˆç‡è·Ÿæ—¢æœ‰çš„ç‰ˆæœ¬åŸºæœ¬ä¸Šä¸€è‡´ï¼Œè€Œä»–ä¹Ÿèªç‚º match æ™‚é–“åœ¨ä»–çœ‹èµ·ä¾†ä¸æœƒæ˜¯é‡è¦çš„å•é¡Œï¼ˆç•¢ç«Ÿæ”¹å–„åˆè¡·æ˜¯æƒ³è¦è®“æ›´å¤šå°ˆæ¡ˆèƒ½ä½¿ç”¨å…§å»º libraryï¼Œè€Œé€™äº›å°ˆæ¡ˆå¯èƒ½åªæœ‰è¨»å†Šç‚ºæ•¸ä¸å¤šçš„ handlerï¼Œè‡ªç„¶ä¹Ÿå°±ä¸æœƒä½”æ“šå¤ªå¤š routing æ™‚é–“ï¼‰ã€‚</p><div class=info-block>ğŸ“–
Detecting conflicts when a pattern is registered seems to require checking all previously registered patterns in general.<br>ğŸ“– Indexing the patterns as they are registered can significantly speed up the common case.</div><p>å¦å¤–ï¼Œé‡å°ç¬¬äºŒå€‹å•é¡Œï¼Œä»–å€‘åœ¨å¯¦ä½œä¸Šä¹Ÿæœ‰æ­¤è€ƒé‡ï¼Œå› æ­¤æœ‰ indexing çš„è¨­è¨ˆä¾†åŠ å¿«æ¯”å°çš„æ•ˆç‡ã€‚ä¸éè¨è«–ä¸Šä¹Ÿæœ‰æåŠåˆ°ï¼Œå¯¦å‹™ä¸Šé‚„æ˜¯éœ€è¦æ”¶é›†æ¡ˆä¾‹é€²è¡Œæ•ˆèƒ½å¯¦é©—æ‰èƒ½è­‰å¯¦ã€‚</p><h2 id=çµèª>çµèª</h2><div class=author-chat-block>å¾é€™å€‹åŠŸèƒ½ä¸­å¯ä»¥çœ‹åˆ°è »å®Œæ•´çš„å°ˆæ¡ˆæµç¨‹ï¼Œå¾ä¸€é–‹å§‹çš„å‹•æ©Ÿã€åŠŸèƒ½éœ€æ±‚ã€æå‡ºåŠŸèƒ½è¨­è¨ˆæ–¹å‘ä¸¦æ¯”è¼ƒå¤šå€‹å¯¦ä½œæ–¹æ¡ˆä¾†é¸æ“‡é©åˆå°ˆæ¡ˆçš„æ–¹æ¡ˆï¼Œé‚„æœ‰èªªæ˜å¯èƒ½é€ æˆçš„å½±éŸ¿ã€‚åœ¨è¨è«–éç¨‹ä¸­ç·Šæ‰£è‘—è¨­è¨ˆåˆè¡·ï¼ŒåŒ…å«ä¸ä¾è³´è¨»å†Šé †åºã€æé«˜å¯¦ç”¨æ€§ç‚ºä¸»è€Œä¸è¿½æ±‚æ•ˆèƒ½æ”¹å–„ï¼Œæ˜¯æˆ‘è¦ºå¾—å¾ˆä¸éŒ¯çš„åœ°æ–¹ã€‚é›–ç„¶æœ€å¾Œæˆæœå¯èƒ½ä¸æ˜¯æ¯å€‹ä½¿ç”¨è€…éƒ½è¦ºå¾—å¾ˆæ£’ XD ç•¢ç«Ÿè¦ä½¿ç”¨è€…å¯«æˆç‰¹å®šçš„æ ¼å¼ [METHOD] [HOST]/[PATH] æ‰å¯ä»¥æ­£ç¢ºåŸ·è¡Œï¼Œä½†éç¨‹ä¸­çš„è¨è«–å’Œç™¼æƒ³é‚„æ˜¯å€¼å¾—å­¸ç¿’çš„ã€‚</div></div><footer class=post-footer><div class=post-nav><a href=https://yushuanhsieh.github.io/posts/2024-02-18-file_uploading/ class="post-nav-link prev"><span class=label>â† Previous</span>
<span class=title>The issue of uploading a large-size file using HTTP formdata</span>
</a><a href=https://yushuanhsieh.github.io/posts/2026-02-18-golang-performance-prs/ class="post-nav-link next"><span class=label>Next â†’</span>
<span class=title>Golang Performance Optimization Report</span></a></div></footer></article></main><footer class=site-footer><div class=footer-inner><p class=footer-copyright>&copy; 2026 Cherie's Tech Blog. All rights reserved.</p><p class=footer-powered>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></p></div></footer></body></html>